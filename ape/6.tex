\section{Séance 6}

\paragraph{Couplages}

\subsection{Couplage maximum}
Étant donné le couplage $M = \left\lbrace  (1,1'), (2,4'),(4,2'),(5,5')  \right\rbrace$ dans le graphe biparti ci-dessous, démontrez que $M$ est maximum.

\begin{figure}[h!]
  \begin{center}
    \begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto]
      \Vertex[x=0 ,y=0]{1}
      \Vertex[x=0 ,y=-1]{2}
      \Vertex[x=0,y=-2]{3}
      \Vertex[x=0 ,y=-3]{4}
      \Vertex[x=0 ,y=-4]{5}
      \Vertex[x=3 ,y=-0]{1'}
      \Vertex[x=3 ,y=-1]{2'}
      \Vertex[x=3 ,y=-2]{3'}
      \Vertex[x=3 ,y=-3]{4'}
      \Vertex[x=3 ,y=-4]{5'}


      \path[every node/.style={font=\sffamily\small}]
      (1) edge [style=dashed]  node [left] {} (1')
      edge node [left] {} (5')

      (2) edge node [right] {} (1')
      edge node [right] {} (2')
      edge node [right] {} (3')
      edge [style=dashed]  node [right] {} (4')
      edge node [right] {} (5')

      (3) edge node [right] {} (1')
      edge node [left] {} (5')

      (4) edge [style=dashed]  node [right] {} (2')
      edge node [right] {} (3')
      edge node [right] {} (4')
      edge node [right] {} (5')

      (5) edge node [right] {} (1')
      edge [style=dashed]  node [left] {} (5');


    \end{tikzpicture}
  \end{center}
\end{figure}
\begin{solution}
	Un couplage est maximum si et seulement s’il n'existe pas de chemin $M$-augmenté.
    Pour rappel, un chemin $M$-augmenté est un chemin qui commence et fini par un noeud hors de $M$ et qui alterne entre arêtes appartenant à $M$ et arête n'appartenant pas à $M$.
	
	On constate qu'il n'existe pas de chemin $M$-augmenté partant ou finissant par $3$: $3\rightarrow 1'\rightarrow 1\rightarrow 5'\rightarrow 5\rightarrow 1'\rightarrow 1\rightarrow 5'\rightarrow 5\rightarrow 1'\rightarrow ...$ (idem en commençant par $3\rightarrow 5'$).
	De la même manière, on constate qu'il n'existe pas non plus de chemin $M$-augmenté partant de $3'$.
	
	Vu que tous les noeuds hors de $M$ ne commencent pas de chemins $M$-augmentés, il n'en existe pas, d'où $M$ est maximum.
\end{solution}

\subsection{Vrai ou faux}
\begin{itemize}
  \item Un arbre possède un couplage parfait si et seulement si tous les chemins d'une feuille à une autre sont de longueur impaire.
  \item Un arbre possède au plus un couplage parfait.
  \item Dans un arbre, si pour tout noeud $u$, il existe une feuille $v$ telle que $d(u,v)$ est impaire, alors cet arbre possède un couplage parfait.
  \item Soit $o(H)$, le nombre de composantes impaires du graphe $H$, c'est-à-dire le nombre de composantes connexes ayant un nombre impair de sommets. Un arbre $G$ admet un couplage parfait si $o(G-v)=1,  \ \ \forall v \in V$.
  \item Si un arbre $G$ admet un couplage parfait, alors $o(G-v)=1, \ \ \forall v \in V$.
\end{itemize}

\begin{solution}
	\begin{itemize}
		\item \textbf{Faux}. Considérer par exemple l'arbre ci-dessous, qui contient un chemin de taille paire entre $5$ et $6$ mais qui contient néanmoins un couplage parfait.
			\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto]
      			\Vertex[x=0 ,y=0]{5}
      			\Vertex[x=1 ,y=0]{6}
     			\Vertex[x=0 ,y=-1]{2}
      			\Vertex[x=1 ,y=-1]{3}
      			\Vertex[x=2 ,y=-1]{4}
      			\Vertex[x=1 ,y=-2]{1}
      			
      			\path[every node/.style={font=\sffamily\small}]
					(1) edge node [left] {} (2)
					(1) edge node [left] {} (3)
					(1) edge [style=dashed]  node [left] {} (4)
					(2) edge [style=dashed]  node [left] {} (5)
					(3) edge [style=dashed]  node [left] {} (6);
      		\end{tikzpicture}
		\item \textbf{Vrai}. Nous sommes forcés de prendre les arêtes qui relient les feuilles au reste de l'arbre. En considérant l'arbre dans lequel on a retiré les noeuds adjacents à ces arêtes, on est de nouveau forcé de prendre les arêtes des nouvelles feuilles, etc., et ce jusqu'à ce qu'au moment où il n’y aura plus de noeuds dans l'arbre. La sélection d'arêtes est donc fixe.
		
		\item \textbf{Faux}. Voir par exemple cet arbre, qui ne contient pas de couplage parfait, mais respecte la propriété.\\
			\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto]
      			\Vertex[x=0 ,y=0]{7}
      			\Vertex[x=0 ,y=-1]{4}
      			\Vertex[x=1 ,y=-1]{5}
      			\Vertex[x=2 ,y=-1]{6}
     			\Vertex[x=1 ,y=-2]{2}
      			\Vertex[x=2 ,y=-2]{3}
      			\Vertex[x=1 ,y=-3]{1}
      			
      			\path[every node/.style={font=\sffamily\small}]
					(1) edge node [left] {} (2)
					(1) edge node [left] {} (3)
					(2) edge node [left] {} (4)
					(2) edge node [left] {} (5)
					(3) edge node [left] {} (6)
					(4) edge node [left] {} (7);
      		\end{tikzpicture}
      	\item \textbf{Vrai}. La preuve s'effectue en construisant le couplage : l'idée étant de montrer qu'il existe une fonction $f(v)$ qui associe à chaque noeud $v$ exactement une de ses arêtes, et que pour toute arête $e$ du couplage, $f(u) = f(v) = e$, où $u$ et $v$ sont les deux extrémités de cette arête. $f(V)$ décrit alors un couplage parfait, car tout noeud doit être adjacent à une arête dans le couplage, et deux arêtes $e$ et $f$ adjacentes entre $u$, $v$ et $w$ ne peuvent pas être en même temps dans le couplage, car sinon on aurait $f(u) = f(v) = f(w)$ et donc $e = f$.
      	
      	Commençons par définir $f$. Lorsqu'on retire un noeud $v$ quelconque du graphe, une seule composante impaire est crée. Soit $e$ l'arête qui joint $v$ à cette composante. On pose $f(v) = e$ ; comme il n'y a qu'une seule composante impaire pour chaque noeud, $f(v)$ est unique.
      	
      	Montrons ensuite que $f(v) = f(u) = e$. Soit une arête quelconque $e$ joignant $u$ et $v$ ; nous allons compter les noeuds de chaque côté de $e$. L'hypothèse $o(G-v) = 1$ implique que le graphe possède un nombre pair de noeuds. On a donc deux cas possibles : $e$ divise l'arbre en deux composantes paires ou $e$ divise l'arbre en deux composantes impaires. Dans le premier cas, retirer $u$ laisse un nombre pair de noeuds du côté de $v$, et un nombre impair du côté de $u$. La composante impair se trouve donc nécessairement du côté de $u$, et on a $f(u) \neq e$. De manière similaire, on montre que $f(v) \neq e$. Dans le deuxième cas, retirer $u$ laisse un nombre impair de noeuds du côté de $v$ et un nombre pair de noeuds du côté de $u$. La composante impair se trouve donc nécessairement du côté de $v$, et on a $f(u) = e$. De manière similaire, on montre que $f(v) = e$. Nous avons donc bien, pour $e \in f(V)$, $f(u) = f(v) = e$.
      	\item \textbf{Vrai}. Tout noeud $v$ est lié à un autre dans le couplage (car il est parfait). En enlevant le noeud $v$, on ne peut donc créer qu'une seule composante connexe impaire, qui contiendra le noeud auquel était lié $v$. Toutes les autres composantes sont forcément paires, car elles ont un couplage parfait.
	\end{itemize}
\end{solution}

\subsection{Assistanat INMA}
Thibault a la responsabilité de répartir les séances d'exercices des cours de mathématiques appliquées entre les assistants du pôle INMA. Chacun des assistants donne pour cela à Thibault une liste de ses cours préférés, qui sont repris dans la table ci-dessous.

\begin{center}
  \begin{tabular}{|c|c|}
    \hline
    Assistant & Cours préférés \\
    \hline
    Pierre & Projet, Théorie des Matrices \\
    Romain & Graphes, Modélisation Stochastique \\
    Arnaud & Théorie des Matrices \\
    Adeline & Graphes, Optimisation, Analyse Numérique \\
    Benoit & Théorie des Matrices, Projet \\
    Nicolas & Graphes, Optimisation, Analyse Numérique, \\
            & Modélisation Stochastique, Théorie des Matrices  \\
    \hline
  \end{tabular}
\end{center}

Thibault aimerait bien assigner exactement un cours à chaque assistant en respectant autant que possible leurs préférences. Formulez cela comme un problème de couplage maximum dans un graphe.

Pour l'aider dans sa tâche, Thibault dispose de la répartition de l'année dernière:

\begin{center}
  \begin{tabular}{|c|c|}
    \hline
    Romain & Modélisation Stochastique \\
    Adeline & Optimisation \\
    Nicolas & Théorie des Matrices \\
    Pierre & Projet \\
    \hline
  \end{tabular}
\end{center}

En partant de la répartition de l'année dernière, utilisez l'algorithme hongrois pour aider Thibault à trouver un couplage maximum. Ce couplage est-il parfait? Proposez un argument pour prouver que le couplage trouvé est effectivement maximum.

\begin{solution}
	En créant un graphe biparti avec nos assistants favoris à gauche et les cours à droite, on construit le graphe suivant(la répartition de l'année dernière est en pointillé):\\
	\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto]
		\SetVertexNormal[Shape=rectangle]
      	\Vertex[x=0,y=-0]{Pierre}
      	\Vertex[x=0,y=-1]{Romain}
      	\Vertex[x=0,y=-2]{Arnaud}
      	\Vertex[x=0,y=-3]{Adeline}
     	\Vertex[x=0,y=-4]{Benoit}
      	\Vertex[x=0,y=-5]{Nicolas}
      	\Vertex[x=10,y=-0]{Projet}
      	\Vertex[x=10,y=-1,L=Théorie des matrices]{Matrices}
      	\Vertex[x=10,y=-2]{Graphes}
      	\Vertex[x=10,y=-3,L=Modélisation Stochastique]{MS}
      	\Vertex[x=10,y=-4,L=Optimisation]{Opti}
      	\Vertex[x=10,y=-5,L=Analyse numérique]{AnaNum}
      			
      	\path[every node/.style={font=\sffamily\small}]
			(Pierre) edge[style=dashed] node [left] {} (Projet)
			(Pierre) edge node [left] {} (Matrices)
			(Romain) edge node [left] {} (Graphes)
			(Romain) edge[style=dashed] node [left] {} (MS)
			(Arnaud) edge node [left] {} (Matrices)
			(Adeline) edge node [left] {} (Graphes)
			(Adeline) edge[style=dashed] node [left] {} (Opti)
			(Adeline) edge node [left] {} (AnaNum)
			(Benoit) edge node [left] {} (Matrices)
			(Benoit) edge node [left] {} (Projet)
			(Nicolas) edge[style=dashed] node [left] {} (Matrices)
			(Nicolas) edge node [left] {} (Graphes)
			(Nicolas) edge node [left] {} (MS)
			(Nicolas) edge node [left] {} (Opti)
			(Nicolas) edge node [left] {} (AnaNum);
    \end{tikzpicture}\\
	Il suffit dès lors de trouver un couplage maximum. Exécutons l'algorithme hongrois. Seuls Arnaud et Benoit n'ont pas de cours assignés, et les cours de Graphes et d'Analyse Numérique n'ont pas d'assistants assignés. Cherchons un chemin $M$-augmenté: le chemin Arnaud$\rightarrow$Théorie des matrices$\rightarrow$Nicolas$\rightarrow$Analyse numérique est $M$-augmenté. On peut donc améliorer le couplage:\\
	\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto]
		\SetVertexNormal[Shape=rectangle]
      	\Vertex[x=0,y=-0]{Pierre}
      	\Vertex[x=0,y=-1]{Romain}
      	\Vertex[x=0,y=-2]{Arnaud}
      	\Vertex[x=0,y=-3]{Adeline}
     	\Vertex[x=0,y=-4]{Benoit}
      	\Vertex[x=0,y=-5]{Nicolas}
      	\Vertex[x=10,y=-0]{Projet}
      	\Vertex[x=10,y=-1,L=Théorie des matrices]{Matrices}
      	\Vertex[x=10,y=-2]{Graphes}
      	\Vertex[x=10,y=-3,L=Modélisation Stochastique]{MS}
      	\Vertex[x=10,y=-4,L=Optimisation]{Opti}
      	\Vertex[x=10,y=-5,L=Analyse numérique]{AnaNum}
      			
      	\path[every node/.style={font=\sffamily\small}]
			(Pierre) edge[style=dashed] node [left] {} (Projet)
			(Pierre) edge node [left] {} (Matrices)
			(Romain) edge node [left] {} (Graphes)
			(Romain) edge[style=dashed] node [left] {} (MS)
			(Arnaud) edge[style=dashed] node [left] {} (Matrices)
			(Adeline) edge node [left] {} (Graphes)
			(Adeline) edge[style=dashed] node [left] {} (Opti)
			(Adeline) edge node [left] {} (AnaNum)
			(Benoit) edge node [left] {} (Matrices)
			(Benoit) edge node [left] {} (Projet)
			(Nicolas) edge node [left] {} (Matrices)
			(Nicolas) edge node [left] {} (Graphes)
			(Nicolas) edge node [left] {} (MS)
			(Nicolas) edge node [left] {} (Opti)
			(Nicolas) edge[style=dashed] node [left] {} (AnaNum);
    \end{tikzpicture}\\
	On constate rapidement qu'il n'existe pas de chemin $M$-augmenté dans ce graphe, et que donc le couplage obtenu est maximum. Un argument ad hoc prouvant ce fait est le suivant: on ne peut pas obtenir un couplage parfait, car s'il en existait un, Théorie des matrices devrait forcément être assigné à Arnaud, d'où Projet devrait forcément être assigné à Pierre (seul choix restant), d'où finalement Benoit n'aurait plus aucun choix, ce qui fait que c'est impossible. Le meilleur couplage ne peut donc contenir que 5 des 6 assistants.
\end{solution}

\subsection{Gagner sans le couplage parfait}
Deux personnes jouent à un jeu sur un graphe $G$ de la manière suivante:

\begin{itemize}
  \item Chacune des deux personnes sélectionne chacune à son tour un sommet $v_1, v_2, v_3, …$ tel que $\forall i > 1, \ \ \ v_i$ est adjacent à $v_{i-1}$.
  \item Un sommet déjà sélectionné ne peut plus être choisi.
  \item La dernière personne à sélectionner un sommet gagne le jeu.
\end{itemize}

Montrer que le premier joueur admet une stratégie gagnante si et seulement si le graphe $G$ n'admet pas de couplage parfait.

\begin{solution}
Nous allons tout d'abord démontrer que s'il existe un couplage parfait, alors le premier joueur peut perdre même avec la meilleure stratégie (ce qui est la contraposée de: si le premier joueur gagne avec la meilleure stratégie, alors il n'existe pas de couplage parfait). Au premier tour, le premier joueur choisit un noeud $v_0$. Si après, à chaque tour du second joueur, ce dernier choisi le noeud couplé au noeud choisi par le premier joueur, on constate qu'on forme un chemin $M$-alterné commençant par une arête de $M$. Un tel chemin ne peut se terminer que sur une arête appartenant à $M$, donc une arête que le second joueur va choisir: il sera donc le dernier à jouer et gagnera.\\
\\
Prouvons maintenant que s'il n'existe pas de couplage parfait, alors le premier joueur peut gagner avec une stratégie optimale.
Soit un couplage $M$ maximum mais qui n'est pas parfait. Étant maximum, $M$ n'admet pas de chemin $M$-augmenté ; étant non-parfait, le graphe admet un noeud qui n'est pas dans $M$. La stratégie est la suivante : le premier joueur commence avec un noeud hors de $M$, puis choisit à chaque fois le noeud couplé à celui du deuxième joueur. Comme le graphe n'admet pas de chemin $M$-augmenté et qu'on a commencé sur un noeud hors du couplage, le chemin ne peut pas se terminer sur un autre noeud hors de $M$, et donc le premier joueur pourra toujours jouer.
\end{solution}

\paragraph{Coloriages d'arêtes}

\subsection{Indice chromatique du graphe de Pétersen}
Déterminez l'indice chromatique du graphe de Pétersen.

\begin{solution}
L'indice chromatique du graphe de Petersen est de 4 comme nous pouvons le voir sur le graphe suivant:

\begin{tikzpicture}[-,>=stealth',shorten >=1pt,auto]
      \Vertex[x=0 ,y=3]{1}
      \Vertex[x=0 ,y=1]{2}
      \Vertex[x=3,y=0]{3}
      \Vertex[x=1 ,y=0]{4}
      \Vertex[x=-3 ,y=0]{5}
      \Vertex[x=-1 ,y=0]{6}
      \Vertex[x=-2 ,y=-3]{7}
      \Vertex[x=-1 ,y=-1]{8}
      \Vertex[x=2 ,y=-3]{9}
      \Vertex[x=1 ,y=-1]{10}


      \path[every node/.style={font=\sffamily\small}]

      (1) edge [color=blue] node [left] {} (3)
      edge [color=black]  node [left] {} (5)
      edge [color=red]  node [left] {} (2)
      
      (2) edge [color=blue] node [left] {} (8)
      edge [color=black]  node [left] {} (10) 
      
      (3) edge [color=red] node [left] {} (4)
      edge [color=black]  node [left] {} (9)    

	 (4) edge [color=blue] node [left] {} (6)
      edge [color=green]  node [left] {} (8) 
      
      (5) edge [color=red] node [left] {} (6)
      edge [color=blue]  node [left] {} (7)
      
      (6) edge [color=green]  node [left] {} (10)
      
      (7) edge [color=black]  node [left] {} (8)
       edge [color=red]  node [left] {} (9)
      
      (9) edge [color=blue]  node [left] {} (10);    

    \end{tikzpicture}
\end{solution}

\subsection{Tournoi d'échecs}
Dans un tournoi d'échecs, chaque engagé doit rencontrer tous les autres. Chaque partie dure une heure. Déterminez la durée minimum du tournoi dans le cas où le nombre d'engagés est 3, 4, ou 5.

\begin{solution}
Dans le problème les noeuds sont les joueurs. Nous avons donc des graphes complets de 3, 4 et 5, car chaque joueur doit rencontrer tous les autres. Le problème se résume à trouver l'indice chromatique ce ceux-ci. En effet, la couleur représentera les "rounds" du tournoi et aussi le nombre d'heures.

Pour $K_{3}$, $K_{4}$ et $K_{5}$, nous avons respectivement 3, 3 et 5 heures.
\end{solution}

\subsection{Carré latin}
Un carré latin est une matrice $n \times n$ dans laquelle les entrées d'une colonne (ou d'une ligne) particulière sont toutes distinctes. Formulez ce problème comme un problème de coloriage d'arêtes et donnez le nombre minimum de symboles qui permettent de satisfaire cette contrainte.
